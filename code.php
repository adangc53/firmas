<?php 
// comprovamos si se enviÃ³ la imagen
$data=$_POST['imagen'];
//$data="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmwAAAFoCAYAAADq7KeuAAAb60lEQVR4Xu3df8y2ZVkH8K+TWglmYSvtlz9KM00r7IewNiWXoAVSA8VBkTRNCtNKoVBDLSuQJoaF6YAkmCgsEythznjXGtRKKvthalpmhbnSHGhu4WrnPN/tDl7e5+F6n/u6j+u8P+c/7ua5r+s8js9xzn33Ps993feJRYAAAQIECBAgUFrgPqWrUxwBAgQIECBAgEAENoeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeAAAECBAgQIFBcQGArPiDlESBAgAABAgQENmeA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";
if (isset($data)) { 

    // mostrar la imagen
    echo '<img src="'.$data.'" border="1">';
    // funcion para gusrfdar la imagen base64 en el servidor
    // el nombre debe tener la extension
    function uploadImgBase64 ($base64, $name){
        // decodificamos el base64
        $datosBase64 = base64_decode(preg_replace('#^data:image/\w+;base64,#i', '', $base64));
        // definimos la ruta donde se guardara en el server
        $path= $_SERVER['DOCUMENT_ROOT'].'/firmas/'.$name;
        // guardamos la imagen en el server
        if(!file_put_contents($path, $datosBase64)){
            // retorno si falla
            return false;
        }
        else{
            // retorno si todo fue bien
            return true;
        }
    }
            //////https://es.stackoverflow.com/questions/99146/guardar-imagen-canvas-autom%C3%A1ticamente-en-servidor-con-php
    // llamamos a la funcion uploadImgBase64( img_base64, nombre_fina.png) 
    uploadImgBase64($data, 'mi_imagen_'.date('d_m_Y_H_i_s').'.png' );
}
?>